<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <script type="text/javascript" src="qrcode.js">
  </script>
  <script type="text/javascript" src="html5-qrcode.js">
  </script>

  <script type="application/javascript" src="../jsHashes-master/hashes.js"></script>
  <script type="application/javascript"></script>


  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    Handshake Generator
  </title>
  <style type="text/css" media="screen">
    body {
      text-align: center;
    }
  </style>
</head>

<body>
  <em>
    Type your unique passphrase here. It will be converted to a long unique ID.
  </em>

  <form name="QRform" id="QRform" onsubmit="event.preventDefault();
      hashGenerated = new Hashes.SHA256().hex(document.getElementById('uniquePassphrase').value);
      urlGenerated = 'https\:\/\/coda-coda.gitlab.io/handshake/Reader/index.html?them=' + hashGenerated;
      document.getElementById('hashed').innerText = hashGenerated;
      document.getElementById('urlGenerated').innerHTML = '<a href=' + urlGenerated + '>' + urlGenerated + '</a>';
      updateQRCode(urlGenerated);
      document.getElementById('qrcode').style.visibility = 'visible';
      ">
    Unique Passphrase: </br>
    <div style="font-size: small;"><em>(you make this up, then you should never change this. Please make sure it is something no-one else would choose so that you don't end up with the same ID as someone else.)</em> </div></br>
    <input type="password" id="uniquePassphrase" name="pwd">
    </br>
    <input type="submit" value="Submit">
  </form>


  <!-- This is where our QRCode will appear in. -->
  <div id="qrcode" style="visibility: hidden; width: 100%;"></div>


  <em>Your unique ID is:</em>
  <div id="hashed"></div>

  <em>Your generated URL is: (which the QR code links to)</em>
  <div id="urlGenerated"></div>

  </br></br>
  <em>How does this work?</em> See: <a href="https://gitlab.com/Coda-Coda/handshake">https://gitlab.com/Coda-Coda/handshake</a>
  </br>
  </br>
  Please note that the current version of handshake <b>does not alert you</b> if a link between you and a case of Covid-19 is found - for now you would need to manually examine the publicly available data (see the links on <a href="https://gitlab.com/Coda-Coda/handshake">https://gitlab.com/Coda-Coda/handshake</a>) looking for links between your hash/unique ID (see just above) and the hashes/unique IDs of others who have reported they are affected by Covid-19 on Handshake.

  <script type="text/javascript">
    function updateQRCode(text) {

      var element = document.getElementById("qrcode");

      var bodyElement = document.body;
      if (element.lastChild)
        element.replaceChild(showQRCode(text), element.lastChild);
      else
        element.appendChild(showQRCode(text));

    }

    updateQRCode('ERROR');
  </script>
</body>

</html>