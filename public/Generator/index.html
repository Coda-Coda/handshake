<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script type="text/javascript" src="qrcode.js">
</script>
    <script type="text/javascript" src="html5-qrcode.js">
</script>

<script type="application/javascript" src="../jsHashes-master/hashes.js"></script>
<script type="application/javascript"></script>



    <title>
      Handshake Generator
    </title>
    <style type="text/css" media="screen">
      body { text-align:center; }
    </style>
  </head>
  <body>
    <em>
      Type your email address here and privacy passphrase here. They will be converted to a long unique id.
    </em>

    <form name="QRform" id="QRform" onsubmit="event.preventDefault();
      hashGenerated = new Hashes.SHA256().hex(document.getElementById('email').value + document.getElementById('privacyPassphrase').value);
      urlGenerated = 'https\:\/\/coda-coda.gitlab.io/handshake/Reader/index.html?them=' + hashGenerated;
      document.getElementById('hashed').innerText = hashGenerated;
      document.getElementById('urlGenerated').innerHTML = '<a href=' + urlGenerated + '>' + urlGenerated + '</a>';
      updateQRCode(urlGenerated);
      document.getElementById('qrcode').style.visibility = 'visible';
      ">
        Email address: </br>
        <input type="text" name="email" id="email" rows="8" cols="50">
        </br>
        Privacy Passphrase </br>
        (you should never change this): </br>
        <input type="password" id="privacyPassphrase" name="pwd"> 
        </br>
        <input type="submit" value="Submit">
      </form>


    <!-- This is where our QRCode will appear in. -->
    <div id="qrcode" style="visibility: hidden;"></div>
    

    <em>Your unique ID is:</em>
    <div id="hashed"></div>

    <em>Your generated URL is: (which the QR code links to)</em>
    <div id="urlGenerated"></div>
    

    <script type="text/javascript">
      function updateQRCode(text) {

        var element = document.getElementById("qrcode");

        var bodyElement = document.body;
        if(element.lastChild)
          element.replaceChild(showQRCode(text), element.lastChild);
        else
          element.appendChild(showQRCode(text));

      }

      updateQRCode('ERROR');
    </script>
  </body>
</html>
