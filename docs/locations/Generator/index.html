<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <script type="text/javascript" src="qrcode.js">
  </script>
  <script type="text/javascript" src="html5-qrcode.js">
  </script>

  <script type="application/javascript" src="../jsHashes-master/hashes.js"></script>
  <script type="application/javascript"></script>

  <script>
    function copyID() {
    document.getElementById("hashedToCopy").value = "Location_" + hashGenerated;
    document.getElementById("hashedToCopy").style.visibility = 'visible';
    var copyText = document.getElementById("hashedToCopy");
    copyText.select();
    copyText.setSelectionRange(0, 99999)
    document.execCommand("copy");
    document.getElementById("hashedToCopy").style.visibility = 'hidden';
    //alert("Copied: " + copyText.value);
    alert("Copied");
}
function copyURL() {
  document.getElementById("urlToCopy").value = urlGenerated;
  document.getElementById("urlToCopy").style.visibility = 'visible';
  var copyText = document.getElementById("urlToCopy");
    copyText.select();
    copyText.setSelectionRange(0, 99999)
    document.execCommand("copy");
    document.getElementById("urlToCopy").style.visibility = 'hidden';
    //alert("Copied: " + copyText.value);
    alert("Copied");
}
  </script>


  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    Handshake Generator for Locations
  </title>
  <style type="text/css" media="screen">
    body {
      text-align: center;
    }
  </style>
  <link rel="stylesheet" type="text/css" href="../../style.css">
  <link href="https://fonts.googleapis.com/css?family=Lato:900&display=swap" rel="stylesheet">
</head>

<body>

  <script type="text/javascript">
    function updateQRCode(text) {

      var element = document.getElementById("qrcode");

      var bodyElement = document.body;
      if (element.lastChild)
        element.replaceChild(showQRCode(text), element.lastChild);
      else
        element.appendChild(showQRCode(text));

    }

    updateQRCode('ERROR');
  </script>

  <br>
  <h1><span class="heading_hand">Hand</span><span class="heading_shake">shake</span></h1>

  <span class="subheading">Track your proximity to COVID-19</span>
  <br>
  <br>
  <span class="normal_text">Create your location's anonymous id:</span>
  <br>
  <br>

  <span class="normal_text">
    Type a unique phrase that no-one else would choose
  </span>
  <br>
  <br>
  <span class="small_text">Please make <em>sure</em> it is something no-one else would choose
    <br>
    <br>
    Such as a few random words that you can remember
    <br>
    <br>
    This ensures that your location doesn't end up with the same anonymous ID as somewhere else
    <br>
    <br>
    For example: "fierce tree folks butter" (it doesn't have to include your place name)
    <br>
    <br>
    Tip: use <a class="normal_text"
      href="https://preshing.com/20110811/xkcd-password-generator/">https://preshing.com/20110811/xkcd-password-generator/</a>
    to generate four unique words.
  </span>
  

  <form name="QRform" id="QRform" onsubmit="event.preventDefault();
      hashGenerated = new Hashes.SHA256().hex(document.getElementById('uniquePassphrase').value);
      urlGenerated = 'https\:\/\/coda-coda.github.io/handshake/Reader/index.html?them=Location_' + hashGenerated;
      document.getElementById('hashed').innerText = 'Location_' + hashGenerated;
      document.getElementById('urlGenerated').innerHTML = '<a href=' + urlGenerated + '>' + urlGenerated + '</a>';
      updateQRCode(urlGenerated);
      document.getElementById('generatedContent').style.visibility = 'visible';
      ">
    <input style="visibility: hidden; height: 0px; width: 0px" type="text"
      name="placeHolderSoThatBrowsersSavePassphrase" id="placeholder" rows="1" cols="1">

    <table class="center">
      <tr>
        <td><span class="normal_text">Unique Phrase:</span> </td>
        <td><input type="password" id="uniquePassphrase" name="pwd"></td>
      </tr>
    </table>
    <br>
    <input class="submit_button" type="submit" value="Click here to generate your location's Handshake QR code">
  </form>


  <span id="generatedContent" style="visibility:hidden">
    <div id="qrcode" style="width: 250px; background-color: white;  margin-left:auto; margin-right:auto;"></div>


    <span class="small_text">Your location's anonymous ID is:</span>
    <span class="tiny_text">
      <div id="hashed"></div>
    </span>
    <button class="copy_button" onclick="copyID()">Click here to copy your location's anonymous ID to clipboard</button>

    <br>

    <span class="small_text">Your location's generated URL is:</span><span class="tiny_text">
      <div id="urlGenerated"></div>
    </span>
    <span class="tiny_text">(send this to people who physically spend time at your location with if QR code scanning is not working)</span>
    <br>
    <button class="copy_button" onclick="copyURL()">Click here to copy your location's URL to clipboard</button>

    
  </span>
 

  <br>
  <br>


  <span class="normal_text">How this works:
    <br>
    <span class="small_text">

      <br>
      Your phrase is '<a class="small_text"
        href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">hashed</a>' to form a unique id.
      <br>
      <br>
      This is done in your browser, your phrase in plain text never leaves your phone or computer.
      <br>
      <br>
      Assuming you used a phrase which included what would be a strong unique password, it is virtually impossible to go from the hash alone back to your
      phrase.
      <br>
      <br>
      However, people still may be able to <a class="small_text"
        href="https://en.wikipedia.org/wiki/Data_re-identification">reidentify your location</a>, especially those who know
      handshake with your location.
      <br>
      <br>
      This is Open Source and so you can <a class="small_text" href="https://github.com/Coda-Coda/handshake/">check
        the source code</a> or "View Source" in your browser as it is only HTML and Javascript.
      <br>
      <br>
      No guarantee of privacy, accuracy of information or any guarantee whatsoever is provided.
      </li>
      </ul>
    </span>

    <br>
    <br>

    <span class="normal_text">See the public record (raw data):

      <br>
      <span class="small_text">
        <br>
        <a class="small_text"
          href="https://docs.google.com/spreadsheets/d/11LaeMly8CQdM7R7MsvE2GSdWZLySA4hNaQ9GrBg53TE/edit?usp=sharing">Handshakes
          Google Spreadsheet</a>
        <br>
        <a class="small_text"
          href="https://docs.google.com/spreadsheets/d/1hcjN_L62VK7hPSIKkfc0YRdFE8ULYG-ebpGgSw3kxgc/edit?usp=sharing">Status
          Reports Google Spreadsheet</a>
        <br>

      </span>

      <br>

      <span class="normal_text">If you want to get involved:</span>
      <span class="small_text">
        <br>
        <br>
        <a class="small_text" href="https://github.com/Coda-Coda/handshake/">Get involved on GitHub</a>
        <br>

        <a class="small_text" href="mailto:get.involved.handshake@gmail.com">Send an email to
          get.involved.handshake@gmail.com</a>
        <br>
      </span>

    </span>


   <input id="hashedToCopy" style="visibility: hidden;"></input> <!--Trick to enable copying to clipboard-->
    <input id="urlToCopy" style="visibility:hidden;"></input>

</body>

</html>